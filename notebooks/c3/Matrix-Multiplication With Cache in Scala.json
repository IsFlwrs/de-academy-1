{"paragraphs":[{"text":"%md\n# Matrix multiplication and cache\n\nWelcome to the notebook with the asasignment for the third session. You’re well on your way to obtain the Wizeline Certification for Big Data Engineering with Spark!\n\nIf you have any feedback about our courses, email us at academy@wizeline.com or use the Academy Slack channel.","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Matrix multiplication and cache</h1>\n<p>Welcome to the notebook with the asasignment for the third session. You’re well on your way to obtain the Wizeline Certification for Big Data Engineering with Spark!</p>\n<p>If you have any feedback about our courses, email us at <a href=\"mailto:&#97;&#99;a&#100;&#x65;&#x6d;y&#x40;&#119;&#105;&#122;&#x65;&#108;i&#x6e;&#101;&#46;&#x63;&#111;&#x6d;\">&#97;&#99;a&#100;&#x65;&#x6d;y&#x40;&#119;&#105;&#122;&#x65;&#108;i&#x6e;&#101;&#46;&#x63;&#111;&#x6d;</a> or use the Academy Slack channel.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116418_-1153126219","id":"20180815-184319_767984790","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:281"},{"text":"%md\n## Big Matrix Multiplication Example\n\nIn this example, you will be able to compare Matrix Multiplication with and without caching on a larger dataset than the ones you have used.\nYou will be challenged to work with one big dataset, and as in the previous session you will transform it into a CoordinateMatrix object, convert it to a BlockMatrix, and calculate a polynomial with that matrix.\n\n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Big Matrix Multiplication Example</h2>\n<p>In this example, you will be able to compare Matrix Multiplication with and without caching on a larger dataset than the ones you have used.<br/>You will be challenged to work with one big dataset, and as in the previous session you will transform it into a CoordinateMatrix object, convert it to a BlockMatrix, and calculate a polynomial with that matrix.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116428_-1158512703","id":"20180816-044039_285868597","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:282"},{"text":"%md\n\nThe file is formatted with the following characteristics:\n    - Each line in the text file is a row in the matrix. \n    - They are comma-separated values. \n    - The first value is the row index starting at one, the remaining values are the Matrix values.","dateUpdated":"2018-08-30T19:08:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The file is formatted with the following characteristics:<br/> - Each line in the text file is a row in the matrix.<br/> - They are comma-separated values.<br/> - The first value is the row index starting at one, the remaining values are the Matrix values.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116430_-1157743206","id":"20180816-050807_2103207409","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283","user":"anonymous","dateFinished":"2018-08-30T19:08:48+0000","dateStarted":"2018-08-30T19:08:45+0000"},{"text":"%md\n\nFirst, import the libraries to use during the session with the following command:","dateUpdated":"2018-08-30T19:08:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>First, import the libraries to use during the session with the following command:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116434_-1146970236","id":"20180820-195656_1562598246","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284","user":"anonymous","dateFinished":"2018-08-30T19:08:48+0000","dateStarted":"2018-08-30T19:08:48+0000"},{"text":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.mllib.linalg.distributed.{BlockMatrix, CoordinateMatrix, MatrixEntry}","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.mllib.linalg.distributed.{BlockMatrix, CoordinateMatrix, MatrixEntry}\n"}]},"apps":[],"jobName":"paragraph_1535656116435_-1147354985","id":"20180816-051038_545285622","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"%md\nNext use `spark.read.textFile` to read the big matrix on the bucket URI: \n`gs://de-training-input/matrices/matrixbig1/*.csv.gz`.\n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Next use <code>spark.read.textFile</code> to read the big matrix on the bucket URI:<br/><code>gs://de-training-input/matrices/matrixbig1/*.csv.gz</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116437_-1149663479","id":"20180816-051039_1898536718","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"text":"val mattuples  = spark.read.csv(\"gs://de-training-input/matrices/matrixbig1a/*.csv.gz\")\nval matentries = mattuples.map(row => MatrixEntry(row(0).toString.toLong, row(1).toString.toLong, row(2).toString.toDouble))","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116438_-1148509232","id":"20180816-070420_1766932377","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"%md\nNow that we have converted all of our lines into `MatrixEntry` objects we need to put them all inside a `BlockMatrix`. Define a function called `create_blockMatrix` that receives one of the previous objects and uses a `CoordinateMatrix` to output a `BlockMatrix`.\n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now that we have converted all of our lines into <code>MatrixEntry</code> objects we need to put them all inside a <code>BlockMatrix</code>. Define a function called <code>create_blockMatrix</code> that receives one of the previous objects and uses a <code>CoordinateMatrix</code> to output a <code>BlockMatrix</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116438_-1148509232","id":"20180816-052746_2109723812","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"def create_blockMatrix(MatrixEntries: Dataset[MatrixEntry]) = {\n    new CoordinateMatrix(MatrixEntries.rdd).toBlockMatrix()\n}\n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116439_-1148893981","id":"20180816-051640_149771352","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"%md\nNow, we convert the `Dataset` into a `BlockMatrix`:","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now, we convert the <code>Dataset</code> into a <code>BlockMatrix</code>:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116439_-1148893981","id":"20180816-051434_624669525","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"text":"val blockBigMatrix = create_blockMatrix(matentries)","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116440_-1150817725","id":"20180816-053544_199438445","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"%md\nNow imagine that you have this polynomials where `x` is our Big Matrix and we need to save the result of each operation on a file\n\n\n$$ 3x^3 + x^2 $$\n$$ x^3 + 2x^2 + x $$\n\n","dateUpdated":"2018-08-30T19:29:55+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now imagine that you have this polynomials where <code>x</code> is our Big Matrix and we need to save the result of each operation on a file</p>\n<p>$$ 3x^3 + x^2 $$<br/>$$ x^3 + 2x^2 + x $$</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116440_-1150817725","id":"20180820-012707_1436435390","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:292","user":"anonymous","dateFinished":"2018-08-30T19:23:31+0000","dateStarted":"2018-08-30T19:23:31+0000"},{"text":"%md\n\nIf we just run the operation like it is and save it, it would take a consider time to complete","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>If we just run the operation like it is and save it, it would take a consider time to complete</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116443_-1150432977","id":"20180816-054044_1121238451","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:293"},{"text":"%md\n**NOTE:** we are converting the `BlockMatrix` back to `CoordinateMatrix` for writing purposes.","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p><strong>NOTE:</strong> we are converting the <code>BlockMatrix</code> back to <code>CoordinateMatrix</code> for writing purposes.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116446_-1151587223","id":"20180816-055549_596649276","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"text":"%md\nOnce the computation is over, save the results to your output bucket. To do so, you will need to transform the `matrix` object into a `CoordinateMatrix`. Then point to its `entries` attribute, using the `saveAsTextFile` method. \n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Once the computation is over, save the results to your output bucket. To do so, you will need to transform the <code>matrix</code> object into a <code>CoordinateMatrix</code>. Then point to its <code>entries</code> attribute, using the <code>saveAsTextFile</code> method.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116446_-1151587223","id":"20180816-051040_524958004","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:295"},{"text":"%md\nLet's explain a little bit the code before just run it.","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Let&rsquo;s explain a little bit the code before just run it.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116447_-1151971972","id":"20180820-200656_760903065","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:296"},{"text":"%md\nWe define our \\\\(x\\\\)\n\n```\nval x = blockBigMatrix\n```","dateUpdated":"2018-08-30T19:24:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>We define our \\(x\\)</p>\n<pre><code>val x = blockBigMatrix\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116447_-1151971972","id":"20180820-200731_991980151","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297","user":"anonymous","dateFinished":"2018-08-30T19:24:27+0000","dateStarted":"2018-08-30T19:24:27+0000"},{"text":"%md\nCalculate \\\\(x^2\\\\) and \\\\(x^3\\\\)\n\n```\nval x3 = x.multiply(x).multiply(x)\nval x2 = x.multiply(x)\n```","dateUpdated":"2018-08-30T19:24:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Calculate \\(x^2\\) and \\(x^3\\)</p>\n<pre><code>val x3 = x.multiply(x).multiply(x)\nval x2 = x.multiply(x)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116448_-1166207681","id":"20180820-200848_1036149003","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298","user":"anonymous","dateFinished":"2018-08-30T19:24:04+0000","dateStarted":"2018-08-30T19:24:04+0000"},{"text":"%md\nSave the \\\\(x^2\\\\) and \\\\(x^3\\\\)\n\n```\nx2.toCoordinateMatrix().entries.saveAsTextFile(\"gs://de-training-output-<user-name>/bigMatrixExample-polynomialx2.txt\")\nx3.toCoordinateMatrix().entries.saveAsTextFile(\"gs://de-training-output-<user-name>/bigMatrixExample-polynomialx3.txt\")\n```","dateUpdated":"2018-08-30T19:10:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Save the \\(x^2\\) and \\(x^3\\)</p>\n<pre><code>x2.toCoordinateMatrix().entries.saveAsTextFile(&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-polynomialx2.txt&quot;)\nx3.toCoordinateMatrix().entries.saveAsTextFile(&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-polynomialx3.txt&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116448_-1166207681","id":"20180820-200926_2048452326","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299","user":"anonymous","dateFinished":"2018-08-30T19:10:10+0000","dateStarted":"2018-08-30T19:10:10+0000"},{"text":"%md\nCompute the result and save it\n\n```\nval result1 = x3.add(x3).add(x3).add(x2)\n\nresult1.toCoordinateMatrix().entries.saveAsTextFile(\"gs://de-training-output-<user-name>/bigMatrixExample-polynomial1.txt\")\n```","dateUpdated":"2018-08-30T19:10:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Compute the result and save it</p>\n<pre><code>val result1 = x3.add(x3).add(x3).add(x2)\n\nresult1.toCoordinateMatrix().entries.saveAsTextFile(&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-polynomial1.txt&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116448_-1166207681","id":"20180820-201016_24118965","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:300","user":"anonymous","dateFinished":"2018-08-30T19:10:20+0000","dateStarted":"2018-08-30T19:10:20+0000"},{"text":"%md\nRepeat the proccess but now for our second polynomial\n\n```\nval result2a = x2.multiply(x).add(x2).add(x2).add(x)\n\nresult2a.toCoordinateMatrix().entries.saveAsTextFile(\"gs://de-training-output-<user-name>/bigMatrixExample-polynomial2a.txt\")\n```","dateUpdated":"2018-08-30T19:10:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Repeat the proccess but now for our second polynomial</p>\n<pre><code>val result2a = x2.multiply(x).add(x2).add(x2).add(x)\n\nresult2a.toCoordinateMatrix().entries.saveAsTextFile(&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-polynomial2a.txt&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116449_-1166592430","id":"20180820-201142_274810150","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:301","user":"anonymous","dateFinished":"2018-08-30T19:10:30+0000","dateStarted":"2018-08-30T19:10:30+0000"},{"text":"%md\nHere, an other workaround to calculate the second polynomial\n\nWe calculate $$ x^2 + x $$\n```\nval x3 = x.multiply(x).add(x)\n```\n\nThen $$ x^3 + x^2 + x^2 + x => x^3 + 2x^2 + x $$\n```\nval result2b = x3.multiply(x).add(x3)\n```\n\nAnd at least, we save the result\n```\nresult2b.toCoordinateMatrix().entries.saveAsTextFile(\"gs://de-training-output-<user-name>/bigMatrixExample-polynomial2b.txt\")\n```","dateUpdated":"2018-08-30T19:25:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Here, an other workaround to calculate the second polynomial</p>\n<p>We calculate $$ x^2 + x $$</p>\n<pre><code>val x3 = x.multiply(x).add(x)\n</code></pre>\n<p>Then $$ x^3 + x^2 + x^2 + x =&gt; x^3 + 2x^2 + x $$</p>\n<pre><code>val result2b = x3.multiply(x).add(x3)\n</code></pre>\n<p>And at least, we save the result</p>\n<pre><code>result2b.toCoordinateMatrix().entries.saveAsTextFile(&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-polynomial2b.txt&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116449_-1166592430","id":"20180820-201238_1078406723","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:302","user":"anonymous","dateFinished":"2018-08-30T19:25:46+0000","dateStarted":"2018-08-30T19:25:46+0000"},{"text":"%md\nWe are going to define a variable to be used instead of your username, **please modify it!**","dateUpdated":"2018-08-30T19:11:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>We are going to define a variable to be used instead of your username, <strong>please modify it!</strong></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116450_-1165438184","id":"20180820-202046_973107264","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:303","user":"anonymous","dateFinished":"2018-08-30T19:11:08+0000","dateStarted":"2018-08-30T19:11:08+0000"},{"text":"val theUsername = \"<user-name>\"","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116450_-1165438184","id":"20180820-202117_652341443","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:304"},{"text":"val x = blockBigMatrix\nval x2 = x.multiply(x)\nval x3 = x2.multiply(x)\nx2.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomialx2.txt\")\nx3.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomialx3.txt\")\nval result1 = x3.add(x3).add(x3).add(x2)\nresult1.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial1.txt\")\nval result2a = x2.multiply(x).add(x2).add(x2).add(x)\nresult2a.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial2a.txt\")\nval x3bis = x.multiply(x).add(x)\nval result2b = x3bis.multiply(x).add(x3bis)\nresult2b.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial2b.txt\")","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116450_-1165438184","id":"20180820-013921_2100202987","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:305"},{"text":"%md\n\nDo you see how much time is needed to complete the operation?\n\nLet's apply some cache!","dateUpdated":"2018-08-30T19:08:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Do you see how much time is needed to complete the operation?</p>\n<p>Let&rsquo;s apply some cache!</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116451_-1165822933","id":"20180820-023941_1083911430","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:306"},{"text":"%md\nAlso, cache applied to \\\\(x2\\\\), so it will not be computed again.\n\n```\nval x2 = x.multiply(x).cache()\n```","dateUpdated":"2018-08-30T19:11:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Also, cache applied to \\(x2\\), so it will not be computed again.</p>\n<pre><code>val x2 = x.multiply(x).cache()\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116451_-1165822933","id":"20180820-201748_1090802896","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:307","user":"anonymous","dateFinished":"2018-08-30T19:11:27+0000","dateStarted":"2018-08-30T19:11:27+0000"},{"text":"%md\nAnd at least the cache is applied to \\\\(x3\\\\)\n\n```\nval x3bis = x.multiply(x).add(x)\n```","dateUpdated":"2018-08-30T19:11:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>And at least the cache is applied to \\(x3\\)</p>\n<pre><code>val x3bis = x.multiply(x).add(x)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116452_-1167746677","id":"20180820-201858_1724845356","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308","user":"anonymous","dateFinished":"2018-08-30T19:11:37+0000","dateStarted":"2018-08-30T19:11:37+0000"},{"text":"val x = blockBigMatrix\nval x2 = x.multiply(x).cache() \nval x3 = x2.multiply(x).cache()\nx2.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomialx2Cache.txt\")\nx3.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomialx3Cache.txt\")\nval result1 = x3.add(x3).add(x3).add(x2)\nresult1.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial1Cache.txt\")\nval result2a = x2.multiply(x).add(x2).add(x2).add(x)\nresult2a.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial2aCache.txt\")\nval x3bis = x.multiply(x).add(x).cache()\nval result2b = x3bis.multiply(x).add(x3bis)\nresult2b.toCoordinateMatrix().entries.saveAsTextFile(s\"gs://de-training-output-$theUsername/bigMatrixExample-polynomial2bCache.txt\")","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116455_-1167361928","id":"20180820-025912_1246977407","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"title":"Exercise time!","text":"%md\n\nCalculate this polynomial: and write the result in: `\"gs://de-training-output-<user-name>/bigMatrixExample-exerciseResult.txt\"`\n\n\n$$ x ^{11} + x^9 + x^7 + x^5 + x^4 + x^3 + x^2 + x $$","dateUpdated":"2018-08-30T19:26:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Calculate this polynomial: and write the result in: <code>&quot;gs://de-training-output-&lt;user-name&gt;/bigMatrixExample-exerciseResult.txt&quot;</code></p>\n<p>$$ x ^{11} + x^9 + x^7 + x^5 + x^4 + x^3 + x^2 + x $$</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535656116456_-1169285673","id":"20180816-061612_1285669371","dateCreated":"2018-08-30T19:08:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310","user":"anonymous","dateFinished":"2018-08-30T19:26:11+0000","dateStarted":"2018-08-30T19:26:11+0000"},{"text":"%md\n","dateUpdated":"2018-08-30T19:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535656116456_-1169285673","id":"20180816-204005_1297364994","dateCreated":"2018-08-30T19:08:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:311"}],"name":"Matrix-Multiplication With Cache in Scala","id":"2DQ1TS41C","angularObjects":{"2DQEJS95N:shared_process":[],"2DPNQYZTB:shared_process":[],"2DPPA2MPZ:shared_process":[],"2DN7VVGU1:shared_process":[],"2DQHQBRXT:shared_process":[],"2DRJV4SMP:shared_process":[],"2DRD3NJ81:shared_process":[],"2DQ8PZ3CH:shared_process":[],"2DQC6T7CS:shared_process":[],"2DPXVZDFP:shared_process":[],"2DRCVP3QA:shared_process":[],"2DRJ4H2CS:shared_process":[],"2DRHA13ME:shared_process":[],"2DNKNQ7VN:shared_process":[],"2DP6Y999A:shared_process":[],"2DQGDCTA9:shared_process":[],"2DPXXVEV5:shared_process":[],"2DNXBJAZD:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}